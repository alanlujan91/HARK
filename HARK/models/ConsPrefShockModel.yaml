description: "MNW's first attempt at the preference shocks model in YAML."
symbols:
  variables:
    - kNrm               \\ beginning of period capital, normalized by p_{t-1}
    - pLvlPrev           \\ inbound permanent income level, before growth
    - yNrm               \\ normalized labor income
    - pLvl               \\ permanent income level
    - bNrm               \\ normalized bank balances
    - mNrm               \\ normalized market resources
    - cNrm               \\ normalized consumption
    - aNrm               \\ normalized end-of-period assets
  pre_states:
    - kNrm
    - pLvlPrev
  parameters:
    - Rfree              \\ risk free return factor on assets
    - PermGroFac         \\ expected permanent income growth factor
  functions:
    - cFunc              \\ consumption function over market resources
  distributions:
    - IncShkDstn         \\ joint distribution of permanent and transitory shocks
    - PrefShkDstn        \\ distribution of marginal utility shocks
    - MortDstn           \\ binary mortality distribution
  solution:
    - cFunc
  offset:
    - PermGroFac
    - Rfree
    - IncShkDstn
initialize: |
  pLvlPrev = 1.                    \\ set initial permanent income to one
  kNrm = 0.                        \\ set initial capital holdings to zero
dynamics: |
  (PermShk, TranShk) ~ IncShkDstn  \\ draw permanent and transitory income shocks
  yNrm = TranShk                   \\ normalized income is the transitory shock
  G    = PermGroFac * PermShk      \\ calculate permanent income growth
  pLvl = pLvlPrev * G              \\ update permanent income level
  bNrm = Rfree * kNrm / G          \\ calculate normalized bank balances
  mNrm = bNrm + yNrm               \\ calculate normalized market resources
  PrefShk ~ PrefShkDstn            \\ draw marginal utility shock
  cNrm = cFunc@(mNrm, PrefShk)     \\ evaluate consumption from market resources
  aNrm = mNrm - cNrm               \\ calculate normalized end-of-period assets
  dead ~ MortDstn                  \\ draw binary death
twist:
  aNrm: kNrm
  pLvl: pLvlPrev
